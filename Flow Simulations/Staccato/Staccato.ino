float curve[] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0062829,0.018847,0.03769,0.062806,0.09419,0.13183,0.17573,0.22586,0.28222,0.34479,0.41357,0.48852,0.56963,0.65689,0.75027,0.84974,0.95529,1.0669,1.1845,1.3081,1.4377,1.5732,1.7146,1.8618,2.0149,2.1737,2.3384,2.5087,2.6846,2.8662,3.0534,3.2461,3.4443,3.6479,3.8569,4.0712,4.2908,4.5157,4.7457,4.9808,5.221,5.4661,5.7162,5.9712,6.231,6.4955,6.7647,7.0385,7.3169,7.5997,7.8807,8.1597,8.4367,8.7117,8.9844,9.255,9.5233,9.7892,10.053,10.314,10.572,10.828,11.081,11.332,11.579,11.824,12.066,12.305,12.541,12.774,13.003,13.23,13.453,13.673,13.889,14.102,14.312,14.518,14.721,14.919,15.114,15.306,15.494,15.677,15.857,16.033,16.205,16.374,16.538,16.698,16.853,17.005,17.153,17.296,17.435,17.569,17.7,17.826,17.947,18.065,18.177,18.285,18.389,18.488,18.583,18.673,18.758,18.839,18.915,18.987,19.054,19.116,19.173,19.226,19.274,19.317,19.355,19.389,19.417,19.441,19.461,19.475,19.485,19.49,19.49,19.485,19.475,19.461,19.441,19.417,19.389,19.355,19.317,19.274,19.226,19.173,19.116,19.054,18.987,18.915,18.839,18.758,18.673,18.583,18.488,18.389,18.285,18.177,18.065,17.947,17.826,17.7,17.569,17.435,17.296,17.153,17.005,16.853,16.698,16.538,16.374,16.205,16.033,15.857,15.677,15.494,15.306,15.114,14.919,14.721,14.518,14.312,14.102,13.889,13.673,13.453,13.23,13.003,12.774,12.541,12.305,12.066,11.824,11.579,11.332,11.081,10.828,10.572,10.314,10.053,9.7892,9.5233,9.255,8.9844,8.7117,8.4367,8.1597,7.8807,7.5997,7.3169,7.0385,6.7694,6.5096,6.2592,6.0183,5.7869,5.565,5.3528,5.1502,4.9574,4.7743,4.601,4.4376,4.2841,4.1406,4.007,3.8834,3.7699,3.6664,3.573,3.4898,3.4166,3.3536,3.3008,3.2582,3.2257,3.2035,3.1914,3.1896,3.198,3.2166,3.2454,3.2843,3.3335,3.3928,3.4623,3.5419,3.6317,3.7316,3.8415,3.9615,4.0915,4.2314,4.3814,4.5412,4.7109,4.8905,5.0798,5.2789,5.4877,5.6998,5.9105,6.1198,6.3275,6.5337,6.7383,6.9413,7.1425,7.3419,7.5395,7.7353,7.9292,8.1211,8.311,8.4989,8.6846,8.8682,9.0497,9.2289,9.4058,9.5804,9.7526,9.9224,10.09,10.255,10.417,10.577,10.734,10.889,11.04,11.19,11.336,11.479,11.62,11.758,11.893,12.025,12.154,12.28,12.403,12.523,12.64,12.754,12.864,12.972,13.076,13.177,13.275,13.369,13.461,13.548,13.633,13.714,13.792,13.866,13.937,14.005,14.069,14.129,14.186,14.24,14.29,14.337,14.38,14.419,14.455,14.487,14.516,14.541,14.563,14.581,14.595,14.606,14.614,14.617,14.617,14.614,14.606,14.595,14.581,14.563,14.541,14.516,14.487,14.455,14.419,14.38,14.337,14.29,14.24,14.186,14.129,14.069,14.005,13.937,13.866,13.792,13.714,13.633,13.548,13.461,13.369,13.275,13.177,13.076,12.972,12.864,12.754,12.64,12.523,12.403,12.28,12.154,12.025,11.893,11.758,11.62,11.479,11.336,11.19,11.04,10.889,10.734,10.577,10.417,10.255,10.09,9.9224,9.7526,9.5804,9.4058,9.2289,9.0497,8.8682,8.6846,8.4989,8.311,8.1211,7.9292,7.7353,7.5395,7.3419,7.1425,6.9413,6.7383,6.5337,6.3275,6.1198,5.9105,5.6998,5.4877,5.2789,5.0771,4.8822,4.6944,4.5137,4.3402,4.1738,4.0146,3.8626,3.718,3.5807,3.4508,3.3282,3.2131,3.1054,3.0052,2.9126,2.8274,2.7498,2.6798,2.6173,2.5625,2.5152,2.4756,2.4436,2.4193,2.4026,2.3936,2.3922,2.3985,2.4124,2.434,2.4632,2.5001,2.5446,2.5967,2.6565,2.7238,2.7987,2.8811,2.9711,3.0686,3.1736,3.286,3.4059,3.5332,3.6679,3.8099,3.9592,4.1158,4.2748,4.4329,4.5898,4.7457,4.9003,5.0537,5.2059,5.3568,5.5064,5.6547,5.8015,5.9469,6.0908,6.2332,6.3741,6.5135,6.6512,6.7872,6.9216,7.0543,7.1853,7.3144,7.4418,7.5674,7.691,7.8128,7.9326,8.0505,8.1664,8.2803,8.3921,8.5019,8.6096,8.7151,8.8185,8.9197,9.0188,9.1156,9.2101,9.3024,9.3924,9.48,9.5653,9.6483,9.7289,9.8071,9.8828,9.9561,10.027,10.095,10.161,10.225,10.286,10.344,10.4,10.453,10.504,10.552,10.597,10.64,10.68,10.718,10.753,10.785,10.814,10.841,10.866,10.887,10.906,10.922,10.936,10.947,10.955,10.96,10.963,10.963,10.96,10.955,10.947,10.936,10.922,10.906,10.887,10.866,10.841,10.814,10.785,10.753,10.718,10.68,10.64,10.597,10.552,10.504,10.453,10.4,10.344,10.286,10.225,10.161,10.095,10.027,9.9561,9.8828,9.8071,9.7289,9.6483,9.5653,9.48,9.3924,9.3024,9.2101,9.1156,9.0188,8.9197,8.8185,8.7151,8.6096,8.5019,8.3921,8.2803,8.1664,8.0505,7.9326,7.8128,7.691,7.5674,7.4418,7.3144,7.1853,7.0543,6.9216,6.7872,6.6512,6.5135,6.3741,6.2332,6.0908,5.9469,5.8015,5.6547,5.5064,5.3568,5.2059,5.0537,4.9003,4.7457,4.5898,4.4329,4.2748,4.1158,3.9592,3.8051,3.6537,3.5049,3.3588,3.2154,3.0747,2.9368,2.8017,2.6694,2.5401,2.4136,2.2901,2.1695,2.0519,1.9374,1.8259,1.7175,1.6123,1.5101,1.4111,1.3153,1.2227,1.1334,1.0473,0.96444,0.88491,0.8087,0.73581,0.66628,0.60013,0.53735,0.47798,0.42203,0.3695,0.32042,0.27479,0.23263,0.19395,0.15875,0.12705,0.098846,0.074156,0.052982,0.035328,0.021201,0.010602,0.0035341,1.4436e-15,1.4384e-15,1.4241e-15,1.4099e-15,1.3959e-15,1.382e-15,1.3682e-15,1.3546e-15,1.3411e-15,1.3278e-15,1.3146e-15,1.3015e-15,1.2885e-15,1.2757e-15,1.263e-15,1.2505e-15,1.238e-15,1.2257e-15,1.2135e-15,1.2014e-15,1.1895e-15,1.1776e-15,1.1659e-15,1.1543e-15,1.1428e-15,1.1315e-15,1.1202e-15,1.1091e-15,1.098e-15,1.0871e-15,1.0763e-15,1.0656e-15,1.055e-15,1.0445e-15,1.0341e-15,1.0238e-15,1.0136e-15,1.0035e-15,9.9353e-16,9.8364e-16,9.7386e-16,9.6417e-16,9.5457e-16,9.4507e-16,9.3567e-16,9.2636e-16,9.1714e-16,9.0802e-16,8.9898e-16,8.9004e-16,8.8118e-16,8.7241e-16,8.6373e-16,8.5514e-16,8.4663e-16,8.3821e-16,8.2987e-16,8.2161e-16,8.1343e-16,8.0534e-16,7.9733e-16,7.8939e-16,7.8154e-16,7.7376e-16,7.6606e-16,7.5844e-16,7.5089e-16,7.4342e-16,7.3602e-16,7.287e-16,7.2145e-16,7.1427e-16,7.0716e-16,7.0013e-16,6.9316e-16,6.8626e-16,6.7944e-16,6.7268e-16,6.6598e-16,6.5936e-16,6.528e-16,6.463e-16,6.3987e-16,6.335e-16,6.272e-16,6.2096e-16,6.1478e-16,6.0866e-16,6.0261e-16,5.9661e-16,5.9067e-16,5.848e-16,5.7898e-16,5.7322e-16,5.6751e-16,5.6187e-16,5.5628e-16,5.5074e-16,5.4526e-16,5.3984e-16,5.3446e-16,5.2915e-16,5.2388e-16,5.1867e-16,5.1351e-16,5.084e-16,5.0334e-16,4.9833e-16,4.9337e-16,4.8846e-16,4.836e-16,4.7879e-16,4.7403e-16,4.6931e-16,4.6464e-16,4.6002e-16,4.5544e-16,4.5091e-16,4.4642e-16,4.4198e-16,4.3758e-16,4.3323e-16,4.2892e-16,4.2465e-16,4.2042e-16,4.1624e-16,4.121e-16,4.08e-16,4.0394e-16,3.9992e-16,3.9594e-16,3.92e-16,3.881e-16,3.8424e-16,3.8042e-16,3.7663e-16,3.7288e-16,3.6917e-16,3.655e-16,3.6186e-16,3.5826e-16,3.547e-16,3.5117e-16,3.4767e-16,3.4421e-16,3.4079e-16,3.374e-16,3.3404e-16,3.3072e-16,3.2743e-16,3.2417e-16,3.2094e-16,3.1775e-16,3.1459e-16,3.1146e-16,3.0836e-16,3.0529e-16,3.0225e-16,2.9925e-16,2.9627e-16,2.9332e-16,2.904e-16,2.8751e-16,2.8465e-16,2.8182e-16,2.7901e-16,2.7624e-16,2.7349e-16,2.7077e-16,2.6807e-16,2.6541e-16,2.6277e-16,2.6015e-16,2.5756e-16,2.55e-16,2.5246e-16,2.4995e-16,2.4746e-16,2.45e-16,2.4256e-16,2.4015e-16,2.3776e-16,2.3539e-16,2.3305e-16,2.3073e-16,2.2844e-16,2.2616e-16,2.2391e-16,2.2169e-16,2.1948e-16,2.173e-16,2.1513e-16,2.1299e-16,2.1087e-16,2.0878e-16,2.067e-16,2.0464e-16,2.0261e-16,2.0059e-16,1.9859e-16,1.9662e-16,1.9466e-16,1.9272e-16,1.9081e-16,1.8891e-16,1.8703e-16,1.8517e-16,1.8333e-16,1.815e-16,1.797e-16,1.7791e-16,1.7614e-16,1.7438e-16,1.7265e-16,1.7093e-16,1.6923e-16,1.6755e-16,1.6588e-16,1.6423e-16,1.626e-16,1.6098e-16,1.5938e-16,1.5779e-16,1.5622e-16,1.5467e-16,1.5313e-16,1.516e-16,1.5009e-16,1.486e-16,1.4712e-16,1.4566e-16,1.4421e-16,1.4277e-16,1.4135e-16,1.3995e-16,1.3855e-16,1.3718e-16,1.3581e-16,1.3446e-16,1.3312e-16,1.318e-16,1.3049e-16,1.2919e-16,1.279e-16,1.2663e-16,1.2537e-16,1.2412e-16,1.2289e-16,1.2166e-16,1.2045e-16,1.1925e-16,1.1807e-16,1.1689e-16,1.1573e-16,1.1458e-16,1.1344e-16,1.1231e-16,1.1119e-16,1.1009e-16,1.0899e-16,1.0791e-16,1.0683e-16,1.0577e-16,1.0472e-16,1.0368e-16,1.0264e-16,1.0162e-16,1.0061e-16,9.961e-17,9.8619e-17,9.7638e-17,9.6666e-17,9.5704e-17,9.4752e-17,9.3809e-17,9.2876e-17,9.1952e-17,9.1037e-17,9.0131e-17,8.9234e-17,8.8346e-17,8.7467e-17,8.6597e-17,8.5735e-17,8.4882e-17,8.4038e-17,8.3201e-17,8.2373e-17,8.1554e-17,8.0742e-17,7.9939e-17,7.9144e-17,7.8356e-17,7.7576e-17,7.6805e-17,7.604e-17,7.5284e-17,7.4535e-17,7.3793e-17,7.3059e-17,7.2332e-17,7.1612e-17,7.09e-17,7.0194e-17,6.9496e-17,6.8804e-17,6.812e-17,6.7442e-17,6.6771e-17,6.6106e-17,6.5449e-17,6.4797e-17,6.4153e-17,6.3514e-17,6.2882e-17,6.2257e-17,6.1637e-17,6.1024e-17,6.0417e-17,5.9815e-17,5.922e-17,5.8631e-17,5.8048e-17,5.747e-17,5.6898e-17,5.6332e-17,5.5772e-17,5.5217e-17,5.4667e-17,5.4123e-17,5.3585e-17,5.3052e-17,5.2524e-17,5.2001e-17,5.1484e-17,5.0971e-17,5.0464e-17,4.9962e-17,4.9465e-17,4.8973e-17,4.8485e-17,4.8003e-17,4.7525e-17,4.7052e-17,4.6584e-17,4.6121e-17,4.5662e-17,4.5208e-17,4.4758e-17,4.4312e-17,4.3871e-17,4.3435e-17};
int red = 3;
int blue = 2;
int buttonPin = 12;
int buttonState = 0;
int prevButtonState = 0;
int outPin = 10;
int outputVals[sizeof(curve)*sizeof(int)/sizeof(float)];

//float inputVals[] = Bell1;
//float outputVals[sizeof(Bell1[])];

void pinSetup(){
  analogWriteResolution(12);
  Serial.begin(9600);
  Serial.println(sizeof(curve)/sizeof(float));
  //Serial.println(sizeof(int));
  //Serial.println(sizeof(float));
  pinMode(red, OUTPUT);
  pinMode(blue, OUTPUT);
  pinMode(outPin, OUTPUT);
  pinMode(buttonPin, INPUT);
  pinMode(13, OUTPUT);
}

int flowToVolt(float flow){
  float out;
  out = 98.11*flow+1733.5;
  out = int(out);
  return out;
}

void setup() {
  pinSetup();
  //analogWriteFrequency(20, 490);
   // analogWriteResolution(12);
  
  for (int i = 0; i < sizeof(curve)/sizeof(float); i++){
    outputVals[i] = flowToVolt(curve[i]);
  }

  digitalWrite(blue, HIGH);
      digitalWrite(13, HIGH);
}

void loop() {
  buttonState = digitalRead(buttonPin);
  if (buttonState == 0 && prevButtonState == 1){
    digitalWrite(blue, LOW);
    digitalWrite(red, HIGH);
    //Serial.println(sizeof(outputVals)/(4*sizeof(int)));
    
    for (int i = 0; i < sizeof(curve)/(sizeof(int)); i++){
      analogWrite(outPin, outputVals[i]);
      Serial.println(outputVals[i]);
      delay(50);
    }
    digitalWrite(red, LOW); 
    digitalWrite(blue, HIGH);
    analogWrite(outPin, 0);  
  }
  
  prevButtonState = buttonState;


}
